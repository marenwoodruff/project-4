<%= render partial: 'layouts/navbar' %>

<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>

<p>
  <h1>
    <%= @coffeeshop.name %>
  </h1>
</p>

<p id="coffeeshop">
  <strong>Address:</strong>
  <%= @coffeeshop.display_address %>
</p>

<p id="coffeeshop">
  <strong>City:</strong>
  <%= @coffeeshop.display_city %>
</p>

<p id="coffeeshop">
  <strong>State:</strong>
  <%= @coffeeshop.display_state %>
</p>

<p id="coffeeshop">
  <strong>Zip:</strong>
  <%= @coffeeshop.display_zip %>
</p>

<p id="coffeeshop">
  <strong>Neighborhood:</strong>
  <%= @coffeeshop.neighborhood %>
</p>

<p id="coffeeshop">
  <strong>Phone:</strong>
  <%= @coffeeshop.phone %>
</p>


<% if @coffeeshop.fair_trade%>
  <p id="coffeeshop">
    <strong>Fair trade: true </strong>
  </p>
<% end %>

<% if @coffeeshop.organic %>
  <p id="coffeeshop">
    <strong>Organic: true </strong>
  </p>
<% end %>

<% if @coffeeshop.direct_trade %> 
  <p id="coffeeshop">
    <strong>Direct trade: true</strong> 
  </p>
<% end %>

<p id="coffeeshop">
  <strong>Yelp rating:</strong>
  <%= @coffeeshop.yelp_rating %>
</p>

<p id="coffeeshop">
  <strong>Yelp review:</strong>
  <%= @coffeeshop.yelp_review %>
</p>

<p id="coffeeshop">
  <strong>Yelp:</strong>
  <%= @coffeeshop.yelp_id %>
</p>

<p id="coffeeshop">
  <strong>Yelp url:</strong>
  <%= link_to @coffeeshop.yelp_url, @coffeeshop.yelp_url %>
</p>

<p id="coffeeshop">
  <strong>Url:</strong>
  <%= link_to @coffeeshop.url, @coffeeshop.url%>
</p>

<%= link_to 'Home Page', coffeeshops_path %> | 
<%= link_to 'Edit', edit_coffeeshop_path(@coffeeshop) %> |




<div>
    <!-- <h1><%#= @coffeeshop.name %> </h1>
    <h3><%#= @coffeeshop.display_city %></h3> -->
    <!-- The "canvas," where our map is rendered -->
    <div id="map-canvas"></div>

    <h4>Nearby locations</h4>
    <ul class="near">
      <% for coffeeshop in @coffeeshop.nearbys(5) %>
        <li><%= link_to coffeeshop.name, coffeeshop %>, (<%= coffeeshop.distance.round(2) %> miles)</li>
      <% end %>
    </ul>
</div>

<!-- Our gmaps4rails handler scripts -->
<script type="text/javascript">
  handler = Gmaps.build('Google');
  // provider is where we pass in mapOptions like zoom, and our API key (not required)
  // internal is where we tell the map where to render and set options like markers, bounds, etc.
  handler.buildMap({ provider: {zoom: 16, provider_key: "AIzaSyCYWhL3gSXTWROdo8CQMOiFyd6YNGzB918"}, internal: {id: 'map-canvas'}}, function(){
    markers = handler.addMarkers([
      {
        lat: <%=@coffeeshop.latitude%>, // pulls in the latitude for the marker via ERB
        lng: <%=@coffeeshop.longitude%>, // pulls in the longitude for the marker via ERB
        infowindow:  "<%=@coffeeshop.name%>"// info window text (this is optional)
      }
    ]);
    handler.map.centerOn(markers[0]); // centers on the first marker in the array
  });



</script>

